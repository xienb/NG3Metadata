<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?80'></script>
<script language="JavaScript">
 function OnReady(id)
 {
  AF.func("Build", "treelist/t18.xml");
  AF.func("MoveCol", "shipcity \r\n Country \r\n false");
 }
 function Retrieve()
 {
  var url = document.getElementById("source").value;
  AF.func("Load", url);
 }
</script>
</head>

<body topmargin=4 vlink=#0000ff link=#0000ff>
<center>
<table cols=4 border=0 width=100%>
<col valign=top width=90>
<col valign=top>
<col valign=top>
<col width=300>
<tr>
<td align=center><img src='res/how.bmp'></td>
<td><b>1</b>.点击"取数"；<br><b>2</b>.修改"运费"，观察小计变化；<br><b>3</b>.点右键选择 "以树方式展示"；</td>
<td><b>4</b>.点击标题"客户号"以重新排序；<br><b>5</b>.将"国家"加入多重排序；<br><b>6</b>.切换回列表方式展示；</td>
<td><b>7</b>.将 "客户号" 列拖到 "国家" 右侧；<br><b>8</b>.在排序区交换"国家"和"客户"位置；</td></tr>
<tr height=4><td colspan=4></td></tr>
<tr height=26><td colspan=4 align=center>填入的数据(相对URL): <input id='source' type=edit size=22 value="treelistdata/data.txt"> <input type=button value=" 取数 " onClick="Retrieve()"></td></tr>
</table>

<div style="position:relative;width:100%;height:395px">
	<script>insertTreeList('AF', '')</script>
</div>

<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.上面的Treelist的中数据和最前面的demo页("感受Treelist"、"以Tree展现")是一致的；<br>
<b>2</b>.该XML描述文件只是多了几个表达式, 就实现了分类汇总；<br>
<b>3</b>.查看<a href="treelist/t18.xml" target=_blank>XML描述文件</a>：<br>
<pre class='xml' maxchars="125">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;TreeList&gt;
&lt;Properties editable="true" sort="country,shipcity" subtotalFontIndex="1" subtotalBgColor="#d3d3d3"/&gt;
&lt;Fonts&gt;
 &lt;Font/&gt;
 &lt;Font faceName="Verdana" weight="700"/&gt;
&lt;/Fonts&gt;
&lt;Cols&gt;
 &lt;Col name="Country"      editAble="false" width="100" subtotalExpress="='共'+@rows+'行'" subtotalAlign="center"&gt;国家&lt;/Col&gt;
 &lt;Col name="OrderID"      editAble="false"  width="70" align="center"&gt;订单号&lt;/Col&gt;
 &lt;Col name="CustomerID"   editAble="false" width="70"&gt;客户号&lt;/Col&gt;
 &lt;Col name="OrderDate"    editAble="false" width="90" datatype="date"&gt;销售日期&lt;/Col&gt;
 &lt;Col name="RequiredDate" editAble="false" width="90" datatype="date"&gt;接单日期&lt;/Col&gt;
 &lt;Col name="Freight"      width="230" datatype="double" decimal="2" subtotalExpress="='小计: ' +@sum+ ', 均价: ' +@ave"&gt;运费&lt;/Col&gt;
 &lt;Col name="ShipName"     editAble="false" width="180"&gt;船名&lt;/Col&gt;
 &lt;Col name="ShipCity"     editAble="false" width="130" subtotalExpress="='共'+@rows+'行'" subtotalAlign="center"&gt;城市&lt;/Col&gt;
 &lt;Col name="ShipAddress"  editAble="false" width="280"&gt;地址&lt;/Col&gt;
&lt;/Cols&gt;
&lt;/TreeList&gt;</pre>
分类汇总表达式在第9、14、16行中.<br>
</td></tr></table>
<table border=0 cols=2 border=0 width=97%>
<tr valign=top><td align=right>这功能太强了吧！</td><td align=left><img src='res/hard.jpg'></td></tr>
</table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</html>