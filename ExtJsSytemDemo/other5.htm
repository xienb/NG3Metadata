<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?80'></script>
<script language="JavaScript">
 function OnEvent(id, Event, p1, p2, p3, p4)
 {
　if( Event != "EditChanged" ) return;
  var objlb1 = document.getElementById('lb1');
  var objlb2 = document.getElementById('lb2');
  var objlb3 = document.getElementById('lb3');
  var objlb4 = document.getElementById('lb4');
  if(id=='AF1') {
    objlb1.innerHTML = "客户1";
    objlb2.innerHTML = AF1.func("getValue", "");
    objlb3.innerHTML = AF1.func("getText", "");
    var handle = AF1.func("GetHandle", "");
    objlb4.innerHTML = getRowInfo(handle);
  }
  else if(id=='AF2') {
    objlb1.innerHTML = "客户2";
    objlb2.innerHTML = AF2.func("getValue", "");
    objlb3.innerHTML = AF2.func("getText", "");
    var handle = AF2.func("GetHandle", "");
    objlb4.innerHTML = getRowInfo(handle);
  }
  else if(id=='AF3') {
    objlb1.innerHTML = "经销商";
    objlb2.innerHTML = AF3.func("getValue", "");
    objlb3.innerHTML = AF3.func("getText", "");
    var handle = AF3.func("GetHandle", "");
    objlb4.innerHTML = getRowInfo(handle);
  }
  else if(id=='AF4') {
    objlb1.innerHTML = "城市";
    objlb2.innerHTML = AF4.func("getValue", "");
    objlb3.innerHTML = AF4.func("getText", "");
    var handle = AF4.func("GetHandle", "");
    objlb4.innerHTML = getRowInfo(handle);
  }
  else if(id=='AF5') {
    objlb1.innerHTML = "途经城市";
    objlb2.innerHTML = AF5.func("getValue", "");
    objlb3.innerHTML = AF5.func("getText", "");
    objlb4.innerHTML = "";
  }
  else if(id=='AF6') {
    objlb1.innerHTML = "图片";
    objlb2.innerHTML = AF6.func("getValue", "");
    objlb3.innerHTML = AF6.func("getText", "");
    var handle = AF6.func("GetHandle", "");
    objlb4.innerHTML = getRowInfo(handle);
//    AF1.func("SetDroplistProp", "treelist=treelist/city.xml;dataCol=city;displayCol=city;isMultiSelectAble=1");
  }
 }

 function getRowInfo(handle)
 {
  var Text="";
  var row  = AF4.func(handle + "GetCurrentRow", "");
  var sCol = AF4.func(handle + "GetNextValidCol", "");
  for(; sCol!=""; sCol=AF4.func(handle + "GetNextValidCol", sCol)) {
    Text += AF4.func(handle + "GetCellData", row + "\r\n" + sCol);
    Text +=", ";
  }
  return Text;
 }
</script>
</head>

<body>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=110>
<col valign=top>
<tr>
<td align=center><img src='res/how.bmp'></td>
<td>这些页面小控件是从Treelist、Freeform中分离出来的，功能和Treelist中的一致；<br>
</td></tr>
</table>


<br>
<table cols=2 width=100% cellpadding=0 cellspacing=0 border=0>
<col align=right width=60%>
<col align=left>

<tr height=31><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF1', 'border=client;type=droptreelist;treelist=treelist/customer.xml;dataCol=customerid;displayCol=companyname;value=ANATR;lefttext=客户1：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(普通下拉)</td></tr>

<tr height=31><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF2', 'border=client;type=editableDroptreelist;treelist=treelist/customer.xml;dataCol=customerid;displayCol=companyname;value=lon;lefttext=客户2：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(可编辑、客户端搜索)</td></tr>

<tr height=31><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF3', 'border=client;type=editableDroptreelist;treelist=treelist/customer2.xml;dataCol=customerid;displayCol=companyname;value=lon;lefttext=经销商：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(可编辑、服务器端搜索)</td></tr>

<tr height=31><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF4', 'border=client;type=droptreelist;treelist=treelist/city.xml;dataCol=city;displayCol=city;value=Salzburg;lefttext=城市：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(下拉树)</td></tr>

<tr height=31><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF5', 'border=client;type=droptreelist;treelist=treelist/city.xml;dataCol=city;displayCol=city;isMultiSelectAble=true;value=Salzburg,Montreal;lefttext=途经城市：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(可多选的下拉)</td></tr>

<tr height=42><td align=right  height=31>
<div style="position:relative;width:340px;height:90%">
	<script>insertEdit('AF6', 'border=client;type=droptreelist;treelist=treelist/t_tip.xml;dataCol=id;displayCol=picture;value=0;lefttext=图片：;editSize=250;bgColor=#ffffff')</script>
</div></td><td>　(图片下拉)</td></tr>

<tr><td/><td/></tr>
</table>
<br><br>


<table cols=2 border=1 width=800 cellpadding=4>
<thead>事件触发：</thead>
<tr align=right><td width=200>内容</td><td align=left><Label style="color:red" id=lb1></Label></td></tr>
<tr align=right><td width=200>值</td><td align=left><Label style="color:red" id=lb2></Label></td></tr>
<tr align=right><td width=200>文字串</td><td align=left><Label style="color:red" id=lb3></Label></td></tr>
<tr height=40 align=right><td width=200>选中行的整行内容(下拉)</td><td align=left><Label style="color:red" id=lb4></Label></td></tr>
</table>

<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style="line-height:21px">
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.这些Edit的创建脚本和前面的演示页没什么差别，只是其创建参数稍复杂：<br>
普通下拉：
<pre class='cpp' maxchars='100'>
insertEdit('AF1', 'type=droptreelist; treelist=treelist/customer.xml; dataCol=customerid; displayCol=companyname; value=ANATR; lefttext=客户1：; editSize=250')</pre><br>
可编辑、客户端搜索：
<pre class='cpp' maxchars='100'>
insertEdit('AF2', 'type=editableDroptreelist; treelist=treelist/customer.xml; dataCol=customerid; displayCol=companyname; value=lon; lefttext=客户2：; editSize=250')</pre><br>
可编辑、服务器端搜索：
<pre class='cpp' maxchars='100'>
insertEdit('AF3', 'type=editableDroptreelist; treelist=treelist/customer2.xml; dataCol=customerid; displayCol=companyname; value=lon; lefttext=经销商：; editSize=250')</pre><br>
下拉树：
<pre class='cpp' maxchars='100'>
insertEdit('AF4', 'type=droptreelist; treelist=treelist/city.xml; dataCol=city; displayCol=city; value=Salzburg; lefttext=城市：; editSize=250')</pre><br>
可多选的下拉：
<pre class='cpp' maxchars='100'>
insertEdit('AF5', 'type=droptreelist; treelist=treelist/city.xml; dataCol=city; displayCol=city; isMultiSelectAble=true; value=Salzburg,Montreal; lefttext=途经城市：; editSize=250')</pre><br>
图片下拉：
<pre class='cpp' maxchars='100'>
insertEdit('AF6', 'type=droptreelist; treelist=treelist/t_tip.xml; dataCol=id; displayCol=picture; value=0; lefttext=图片：; editSize=250')</pre>
如果您已经熟悉了Treelist的下拉，相信对这些参数应该一目了然。<br>
<br>
<b>2</b>.关于事件，在此就不作分析，请您查看本页面的源码.
</td></tr></table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</html>