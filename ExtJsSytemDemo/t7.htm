<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link rel="stylesheet" href="res/temp1.css" type="text/css">
<script type='text/javascript' src='binary/dynaload.js?80'></script>
<script language="JavaScript">
 function OnReady(id)
 {
  AF.func("Build", "treelist/t12.xml");
 }
 
 var bFixBottom=false;
 function fixTotal()
 {
  bFixBottom = !bFixBottom;
  AF.func("SetProp", "isFixTotalRow \r\n " + bFixBottom);
 }
 function addTotalRow()
 {
	AF.func("SetColProp", "productID\r\n totalExpress2 \r\n ='均 价'");
	AF.func("SetColProp", "total\r\n totalExpress2 \r\n =@average");
 }
</script>
</head>

<body vlink=#0000ff link=#0000ff>
<center>

<table cols=2 border=0 width=100%>
<col valign=top width=90>
<col valign=top>
<tr>
<td align=center><img src='res/how.bmp'></td>
<td><b>1</b>.横向逻辑关系：单价、数量、金额三者之间有运算逻辑；数量、库存量、实际可用数三者间也有计算逻辑；<br>
<b>2</b>.纵向逻辑关系：合计行；<br>
<b>3</b>.在粗体列中任意输入数据，查看横向、纵向数据的变化；<br>
</td></tr>
<tr height=7><td/><td/></tr>
</table>

<div style="position:relative;width:881px;height:240px">
	<script>insertTreeList('AF', '')</script>
</div>
注：也可以让合计行紧挨底边(不滚动)：<input type="button" value=" 切换 " onClick="fixTotal()">; 　　允许有多个合计行：<input type="button" value=" 多个合计行 " onClick="addTotalRow()">

<!--  以下为技术分析区 -->
<br><br><br>
<table border=0 cols=1 border=0 width=97% style='line-height:21px'>
<tr><td><img src='res/tech.jpg'></td></tr><tr><td>
<b>1</b>.分析Treelist的<a href="treelist/t12.xml" target=_blank>XML描述文件</a>，横向逻辑关系表达式就在&lt;express&gt;中:<br>
<pre class='xml'>
&lt;TreeList&gt;
 &lt;Properties editAble="true" rowHeight="22" addRowAble="true" totalBgColor="#ffff00"&gt;
  &lt;expresses&gt;
   &lt;!-- 金额 ＝ 单价 X 数量 --&gt;
   &lt;express&gt;total=round(price*num, 2)&lt;/express&gt;
   &lt;!-- 单价 ＝ 金额 / 数量 --&gt;
   &lt;express&gt;price=round(total/num, 4)&lt;/express&gt;
   &lt;!-- 其它 --&gt;
   &lt;express&gt;inuse=stock - inuse@origin - num&lt;/express&gt;
  &lt;/expresses&gt;
 &lt;/Properties&gt;
 ...(略)</pre>
纵向的逻辑：合计表达式，在名为“total”的列的属性中：<br>
<pre class='xml'>
...
&lt;Col name="total" datatype="double" decimal="2" totalExpress="=@sum"&gt;总价&lt;/Col&gt;
...</pre>
<b>2</b>.上面出现的 round( )函数、@origin宏、@sum宏 的含义请参见“开发文档”之“公共内容”.</td></tr></table>
<br>
<table border=0 cols=2 border=0 width=97%>
<tr valign=top><td align=right><img src='res/boy.gif'></td><td align=left>使用够简单吧！</td></tr>
</table>

<br>
</center>
</body>
<script type='text/javascript' src='res/nstd.js'></script>
</html>